{#
    News & Events Landing Template
#}

{% extends "layouts/base/_base" %}

{% set title = entry.title %}

{# HTML #}
{% block content %}

<header id="news-events--intro">
  <div id="news-events--intro-text">
    <h1>{{ entry.title }}</h1>
    {%- if entry.headline -%}<h2>{{ entry.headline }}</h2>{%- endif -%}
    {%- if entry.leadIn -%}<p>{{ entry.leadIn }}</p>{%- endif -%}
  </div>
</header>

{# Is anything featured? #}
{%- if entry.featuredArticle | length -%}
  {# Get an array of filtered article ID's #}
  {% set featuredIds = entry.featuredArticle.ids() %}
  {% set queryParams = {
      'section' : 'newsEvents',
      'id' : 'and, ' ~ featuredIds | join(', ')
    } %}
  <section class="news-events--featured-article">
    {% for entry in craft.entries(queryParams).limit(1) %}
      {% include 'modules/content/_block-news-events-featured' %}
    {% endfor %}
  </section>
{%- endif -%}

<nav id="news-events--nav">

</nav>

<section id="news-events--articles-list">
  {# Is anything featured? #}
  {%- if entry.featuredArticle | length -%}
    {# Exclude featured ids from the results #}
    {# {% set queryParams = {
      'section' : 'newsEvents',
      'id' : 'and, not ' ~ featuredIds | join(', not '),
      'type' : 'and, not event, not story',
    } %} #}
    {% set queryParams = {
      'section' : 'newsEvents',
      'id' : 'and, not ' ~ featuredIds | join(', not '),
      'type' : 'and, not event'
    } %}

  {%- else -%}

    {# {% set queryParams = {
      'section' : 'newsEvents',
      'type' : 'and, not event, not story',
    } %} #}
    {% set queryParams = {
      'section' : 'newsEvents',
      'type' : 'and, not event'
    } %}

  {%- endif -%}

  {% paginate craft.entries(queryParams).limit(6) as pageInfo, recentNews %}
  {% for entry in recentNews %}
    {% include 'modules/content/_block-news-events-entry' %}
  {% endfor %}

  {% include 'modules/nav/_pagination' %}
</section>


{% endblock %}
